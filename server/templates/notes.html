{% extends "base.html" %}

{% block title %}Notas{% endblock %}

{% block page_title %}Notas{% endblock %}

{% block content %}
<div class="container-fluid h-100">
    <div class="row h-100">
        <!-- Sidebar de Notas -->
        <div class="col-md-3 notes-sidebar">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5 class="mb-0">Minhas Notas</h5>
                <button class="btn btn-primary btn-sm" onclick="createNewNote()">
                    <i class="bi bi-plus-lg"></i> Nova Nota
                </button>
            </div>
            
            <!-- Barra de Pesquisa -->
            <div class="search-bar mb-3">
                <div class="input-group">
                    <span class="input-group-text">
                        <i class="bi bi-search"></i>
                    </span>
                    <input type="text" class="form-control" placeholder="Pesquisar notas..." id="searchNotes">
                </div>
            </div>

            <!-- Lista de Notas -->
            <div class="notes-list" id="notesList">
                <!-- Notas serão preenchidas via JavaScript -->
            </div>
        </div>

        <!-- Editor de Notas -->
        <div class="col-md-9 note-editor">
            <div class="editor-toolbar mb-2">
                <div class="btn-group">
                    <button class="btn btn-outline-secondary" onclick="formatText('bold')">
                        <i class="bi bi-type-bold"></i>
                    </button>
                    <button class="btn btn-outline-secondary" onclick="formatText('italic')">
                        <i class="bi bi-type-italic"></i>
                    </button>
                    <button class="btn btn-outline-secondary" onclick="formatText('heading')">
                        <i class="bi bi-type-h1"></i>
                    </button>
                    <button class="btn btn-outline-secondary" onclick="formatText('list')">
                        <i class="bi bi-list-ul"></i>
                    </button>
                </div>
                
                <div class="btn-group ms-2">
                    <button class="btn btn-outline-secondary" onclick="insertLink()">
                        <i class="bi bi-link-45deg"></i>
                    </button>
                    <button class="btn btn-outline-secondary" onclick="insertImage()">
                        <i class="bi bi-image"></i>
                    </button>
                    <button class="btn btn-outline-secondary" onclick="insertCode()">
                        <i class="bi bi-code-slash"></i>
                    </button>
                </div>

                <div class="ms-auto">
                    <button class="btn btn-success" onclick="saveNote()">
                        <i class="bi bi-save"></i> Salvar
                    </button>
                </div>
            </div>

            <div class="editor-container">
                <input type="text" class="form-control note-title mb-2" placeholder="Título da nota" id="noteTitle">
                <div class="form-floating h-100">
                    <textarea class="form-control h-100" id="noteContent" placeholder="Conteúdo da nota"></textarea>
                    <label for="noteContent">Conteúdo da nota</label>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    let currentNote = null;

    function createNewNote() {
        currentNote = null;
        document.getElementById('noteTitle').value = '';
        document.getElementById('noteContent').value = '';
        showToast('Nova nota criada', 'info');
    }

    function formatText(type) {
        const textarea = document.getElementById('noteContent');
        const start = textarea.selectionStart;
        const end = textarea.selectionEnd;
        const text = textarea.value;
        
        let formattedText = '';
        switch(type) {
            case 'bold':
                formattedText = `**${text.substring(start, end)}**`;
                break;
            case 'italic':
                formattedText = `*${text.substring(start, end)}*`;
                break;
            case 'heading':
                formattedText = `\n# ${text.substring(start, end)}`;
                break;
            case 'list':
                formattedText = `\n- ${text.substring(start, end)}`;
                break;
        }
        
        textarea.value = text.substring(0, start) + formattedText + text.substring(end);
    }

    async function saveNote() {
        const title = document.getElementById('noteTitle').value;
        const content = document.getElementById('noteContent').value;
        
        if (!title || !content) {
            showToast('Preencha título e conteúdo', 'warning');
            return;
        }

        showLoading();
        try {
            // Implementar salvamento no backend
            showToast('Nota salva com sucesso!', 'success');
        } catch (error) {
            showToast('Erro ao salvar nota', 'danger');
        } finally {
            hideLoading();
        }
    }

    // Inicialização
    document.addEventListener('DOMContentLoaded', () => {
        // Implementar carregamento inicial das notas
    });
</script>
{% endblock %} 